<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="styles.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    
      <style>
  p {
    color: red;
  }
  </style>
  </head>
  
  <body onload="document.getElementById('player').src = ''">    
  <h2>No Score 70</h2>
  <p>Not loaded yet.</p>
  <div class="row">
  <div class="column left">
  <input type="text" value="manchester city vs southampton 2017" id="queryText" size="80">
  <button type="button" onclick="searchQ()">Search</button>
  <br>
  <div id="list1">
  </div>
  </div>
  <div class="column right">
  <iframe id="player" width="100%" height="80%" src="" frameborder="1" allowfullscreen>
  </iframe>
  </div>
</div>
 
 <script>
 var maxRes = 20; 
   
var val1 = 'AIzaSyAFV5dB';
var val2 = '0CKCkb7L3ddrZYVL9bxr4lB31s';
var val = val1 + '-' + val2;
  
 function searchQ(){
 
      query = document.getElementById('queryText').value;
      email = 'https://www.googleapis.com/youtube/v3/search?part=snippet' +'&maxResults='+ maxRes +
      '&order=viewCount&date&q='+ query + '&key=' + val +
      '&callback=myPlan';
      var oldsearchS = document.getElementById('searchS');
      if(oldsearchS){
            oldsearchS.parentNode.removeChild(oldsearchS);
      }
      var s = document.createElement('script');
      s.setAttribute('src', email);
      s.setAttribute('id','searchS');
      s.setAttribute('type','text/javascript');
      document.getElementsByTagName('head')[0].appendChild(s);
  }
    
  function myPlan(response){
      var stList = '<table id="res1" border="1" cellspacing="0" width="100%"><tbody>'; 
      for (var i=0; i<response.items.length;i++){
        
          var vid = response.items[i].id.videoId; 
       
 
         
        
          var channelTitle  =  response.items[i].snippet.channelTitle;
        
          var videodatetime = response.items[i].snippet.publishedAt; // date time published
          var videodate = videodatetime.substr(0, 10);
        
          var videolang = response.items[i].snippet.defaultAudioLanguage;
        //  console.log('Language: ' + videolang + 'channelTitle: ' + channelTitle);
                
            $(function() {
                 $( "p" ).text( "The DOM is now loaded and can be manipulated." );
           });
        
         $.get("https://www.googleapis.com/youtube/v3/videos",
                   {
                        part: ('contentDetails','statistics'),
                        id: vid, 
                        key: val
                    },

                    function(data) 
                    {
                       var video_details = data.items[0];
                      //  var duration = data.contentDetails.duration; 
                      var viewCount = video_details.statistics.viewCount;
                      $( "p" ).text(viewCount );
                      console.log(video_details);
                    }
                );
   
        
          if(typeof vid != 'undefined'){    
              stList += '<tr><td style="width:30%">'+
                '<a class="show" href="#" id="'+ vid + '" onclick="playVid(this);'+
                ' return false">'+ vid +'</a></td>'+
                '<td>'+ 'Published: ' + videodate + ' / Channel: ' + channelTitle + ' / Language: ' + videolang +
                ' / Views: ' + $( "p" ).text +
                '</td></tr>';
          }
        
      }
      document.getElementById('list1').innerHTML = stList + '</tbody></table>';
  }
  
  function playVid(thi){
      var st = 'https://www.youtube.com/embed/'+thi.id+'?autoplay=1&showinfo=0';
      document.getElementById('player').src = st; 
  }
 
</script>
</body></html>
